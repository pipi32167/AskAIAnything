<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>复制 Markdown 功能测试</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .demo-controls {
      margin-bottom: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
    }

    button {
      margin: 5px;
      padding: 8px 16px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: white;
      cursor: pointer;
    }

    button:hover {
      background: #e9ecef;
    }

    .test-content {
      margin-top: 20px;
      padding: 20px;
      background: #fff3cd;
      border-radius: 6px;
      border: 1px solid #ffeaa7;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>复制 Markdown 功能测试</h1>

    <div class="demo-controls">
      <h3>测试说明</h3>
      <p>这个页面用于测试新增的"复制 Markdown"功能。</p>
      <button onclick="addSampleData()">添加测试历史记录</button>
      <button onclick="clearSampleData()">清空数据</button>
    </div>

    <div class="test-content">
      <h3>测试内容</h3>
      <p><strong>选择这段文字进行测试：</strong></p>
      <p>这是一段用于测试 AI 文字解释扩展的示例文本。你可以选中这段文字，然后使用右键菜单调用 AI 解释功能。测试完成后，在历史记录中应该能看到新增的"复制 Markdown"按钮。</p>

      <h4>Markdown 测试文本：</h4>
      <ul>
        <li><strong>粗体文字</strong></li>
        <li><em>斜体文字</em></li>
        <li><code>代码片段</code></li>
      </ul>
    </div>

    <!-- 嵌入侧边栏组件进行测试 -->
    <iframe src="sidebar.html" width="100%" height="600"
      style="border: 1px solid #ddd; border-radius: 6px; margin-top: 20px;"></iframe>
  </div>

  <script>
    function addSampleData() {
      const sampleHistory = [
        {
          text: "这是一段用于测试的文本，包含了**粗体**和*斜体*格式。",
          explanation: "这是一个测试解释，包含了 Markdown 格式：\n\n**主要内容：**\n- 测试文本包含了 Markdown 格式\n- 粗体使用 `**` 包围\n- 斜体使用 `*` 包围\n\n*提示：* 这是为了测试复制 Markdown 功能而创建的示例。",
          timestamp: new Date().toLocaleString("zh-CN"),
          promptName: "文字解释",
          sourceInfo: "测试页面",
          pageUrl: window.location.href,
          pageTitle: document.title
        },
        {
          text: "JavaScript 是一种编程语言",
          explanation: "## JavaScript 简介\n\nJavaScript 是一种：\n\n1. **动态编程语言**\n2. **解释型语言**\n3. **面向对象的语言**\n\n### 主要用途\n- 前端开发\n- 后端开发（Node.js）\n- 移动应用开发\n\n> JavaScript 最初是为网页交互而设计的语言。",
          timestamp: new Date(Date.now() - 300000).toLocaleString("zh-CN"),
          promptName: "技术解释",
          sourceInfo: "编程概念",
          pageUrl: "https://developer.mozilla.org/zh-CN/docs/Web/JavaScript",
          pageTitle: "JavaScript - MDN Web Docs"
        }
      ];

      if (typeof chrome !== 'undefined' && chrome.storage) {
        chrome.storage.local.set({ history: sampleHistory }, () => {
          alert('测试数据已添加！刷新页面或重新打开扩展查看效果。');
        });
      } else {
        // 模拟添加到本地存储（用于开发测试）
        localStorage.setItem('testHistory', JSON.stringify(sampleHistory));
        alert('测试数据已添加到本地存储！');
      }
    }

    function clearSampleData() {
      if (typeof chrome !== 'undefined' && chrome.storage) {
        chrome.storage.local.set({ history: [] }, () => {
          alert('数据已清空！');
        });
      } else {
        localStorage.removeItem('testHistory');
        alert('数据已清空！');
      }
    }
  </script>
</body>

</html>